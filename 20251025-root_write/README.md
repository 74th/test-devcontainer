macOS上で、各コンテナランタイムで動かしてみるテスト。

## テスト内容

1. uid/gidの変換機構の動作確認
  - 1-1. root権限でコンテナ内に入り、書き込んでも、ホスト側のuid/gidになること
  - 1-2. 現在のユーザでコンテナ内に入り、書き込んでも、ホスト側のuid/gidになること
2. `-e 8080:80`で、ホストからlocalhost:8080でアクセスできるようになること
3. docker-composeで立ち上げて、portsの設定で、ホストからlocalhost:8080でアクセスできるようになること
4. docker-composeで立ち上げたコンテナ内から、コンテナ名で、別のコンテナにアクセスできること
5. amd64コンテナが動くこと

## 対象のツール

- Docker Desktop
- Podman Desktop
- Rancher Desktop
- Colima
- Finch

## 見つかった課題

逆に言うと、以下に挙げる課題以外は、心配なく動作した。

### ホストのファイルシステムのUID差異の問題

ホストのファイルシステムのUIDとGIDがコンテナ内のシステムのユーザIDと異なるため、コンテナ内にマウントするときにUID、GIDの変換が必要になる。

Docker Desktopの場合、コンテナをrootで実行していたとしても、マウント時にUIDをrootに変換され、書き込み時にホスト側のUIDに変換される。

#### Podman Desktop

Podman Desktopにおいて、ローカルをマウントした場合、ローカルのUID、GIDがそのままコンテナ内にマウントされる。
rootとして書き込む分には、ホストのユーザのUIDに変換される。
逆に、コンテナ内で特定のUIDで書き込もうとしたときに動作しないことがある。

#### それ以外のツール

Docker Desktopと同様の挙動を再現しているように見えます。

### Finchのcomposeのイメージビルド

イメージをビルドした時に、compose上でビルドしたイメージを、起動時に参照できない問題が発生した。
